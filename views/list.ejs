<html>

<head>
    <title>Home Page</title>
    <%- include('partials/links') %>
</head>

<body>
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <h3 class="mt-3 text-center">User Dashboard</h3>
                <div class=" mt-5">
                    <div class="card-body">
                        <div class="row">
                            <!-- <div class="col-sm-1">
                                
                            </div> -->
                            <div class="col-sm-3">
                                <button class="btn btn-primary" type="button"> <a href="/" class="text-white">
                                    <i class="icon-plus icons mr-1"></i>Add User</a></button>                        
                            </div>

                            <div class="col-sm-9">

                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12 table-responsive">
                      <table class="table table-striped table-bordered datatable dataTable no-footer" id="DataTables_Table_0"
                        role="grid" aria-describedby="DataTables_Table_0_info" style="border-collapse: collapse !important">
                        <thead>
                          <tr role="row">
                            <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0"
                              aria-label="Role: activate to sort column ascending">User Name</th>
                            <th class="sorting_asc" tabindex="0" aria-controls="DataTables_Table_0" aria-sort="ascending"
                              aria-label="Username: activate to sort column descending">Phone No.</th>
                            <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0"
                              aria-label="Role: activate to sort column ascending">Email</th>
                            <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0"
                              aria-label="Role: activate to sort column ascending">Address</th>
                            <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0"
                              aria-label="Actions: activate to sort column ascending">ACTIONS</th>
                          </tr>
                        </thead>
                        <tbody>
                          <% data.forEach(function(userData){ %>
                            <tr role="row" class="odd">
                            <td><%=userData.userName %> </td>
                            <td><%=userData.phoneNo %> </td>
                            <td><%=userData.email %> </td>
                            <td><%=userData.address %> </td>
                            <td>
                              <div class="d-flex">
                                <a href="/api/edit/<%=userData._id %>" class=" mr-1" >
                                  <i class="fa fa-edit" aria-hidden="true"></i>
                                </a>
                                <button type="button" style="color: #007bff;" onclick="deleteUser( '<%=userData._id %>' )">
                                  <i class="fa fa-trash" aria-hidden="true"></i>
                                </button>
                                <!-- <a href="#">
                                  <i class="fa fa-eye" aria-hidden="true" data-toggle="tooltip" data-placement="top" title="view"></i>
                              </a> -->
                              </div>
          
                            </td>
          
                          </tr>
                          <% }); %>
                        </tbody>
                      </table>
          
                    </div>
                  </div>
            </div>
        </div>
    </div>
    <script>

        function deleteUser(userId) {
              let response = fetch('/api/remove/'+userId, {
                  method: 'DELETE',
                  headers: {
                      'Content-type': 'application/json; charset=UTF-8'
                    },
              }).then(response => response.json())
                  .then(result =>  {
                      if(result.success){
                          location.href = window.location.origin+'/api/people'
                      }
              });
            
        }
    </script>

</body>

</html>